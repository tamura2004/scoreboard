(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[429],{1193:(e,r,t)=>{"use strict";t.d(r,{Q:()=>d,S:()=>c});var i=t(5155),o=t(2115),a=t(7199);let l=(0,o.createContext)(void 0),s={PLAYERS:"scoreboard_players",HISTORY:"scoreboard_history",REGISTERED_PLAYERS:"scoreboard_registered_players"},n=[{id:"1",name:"プレイヤー1",score:0},{id:"2",name:"プレイヤー2",score:0},{id:"3",name:"プレイヤー3",score:0},{id:"4",name:"プレイヤー4",score:0}],d=()=>{let e=(0,o.useContext)(l);if(!e)throw Error("useScore must be used within ScoreProvider");return e},c=e=>{let{children:r}=e,[t,d]=(0,o.useState)(n),[c,h]=(0,o.useState)([]),[x,m]=(0,o.useState)([]),[p,g]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{(()=>{try{let e=localStorage.getItem(s.PLAYERS),r=localStorage.getItem(s.HISTORY),t=localStorage.getItem(s.REGISTERED_PLAYERS);e&&d(JSON.parse(e)),r&&h(JSON.parse(r)),t&&m(JSON.parse(t))}catch(e){console.error("Failed to load from localStorage:",e)}finally{g(!0)}})()},[]),(0,o.useEffect)(()=>{if(p)try{localStorage.setItem(s.PLAYERS,JSON.stringify(t))}catch(e){console.error("Failed to save players to localStorage:",e)}},[t,p]),(0,o.useEffect)(()=>{if(p)try{localStorage.setItem(s.HISTORY,JSON.stringify(c))}catch(e){console.error("Failed to save history to localStorage:",e)}},[c,p]),(0,o.useEffect)(()=>{if(p)try{localStorage.setItem(s.REGISTERED_PLAYERS,JSON.stringify(x))}catch(e){console.error("Failed to save registered players to localStorage:",e)}},[x,p]),(0,i.jsx)(l.Provider,{value:{players:t,history:c,registeredPlayers:x,addPlayer:()=>{if(t.length>=a.iq)return void alert("プレイヤーは最大".concat(a.iq,"人までです"));let e={id:Date.now().toString(),name:"プレイヤー".concat(t.length+1),score:0};d([...t,e])},removeLastPlayer:()=>{if(t.length<=a.wC)return void alert("プレイヤーは最低".concat(a.wC,"人必要です"));let e=t[t.length-1];d(t.slice(0,-1)),h(c.filter(r=>r.playerId!==e.id))},updatePlayerName:(e,r)=>{d(t.map(t=>t.id===e?{...t,name:r}:t)),h(c.map(t=>t.playerId===e?{...t,playerName:r}:t))},addScore:(e,r)=>{let i=t.find(r=>r.id===e);if(!i)return;let o=i.score+r;if(o<a.o||o>a.sz)return void alert("スコアは".concat(a.o,"-").concat(a.sz,"の範囲で入力してください"));let l=c.filter(r=>r.playerId===e).length,s={id:Date.now().toString(),playerId:e,playerName:i.name,score:r,totalScore:o,timestamp:Date.now(),sequenceNumber:l+1};d(t.map(r=>r.id===e?{...r,score:o}:r)),h([s,...c])},undoHistory:e=>{let r=c.find(r=>r.id===e);if(!r||!t.find(e=>e.id===r.playerId))return;let i=r.totalScore-r.score;d(t.map(e=>e.id===r.playerId?{...e,score:i}:e)),h(c.filter(r=>r.id!==e))},resetAll:()=>{d(n),h([])},addRegisteredPlayer:e=>{m([...x,{id:Date.now().toString(),name:e.trim()}])},updateRegisteredPlayer:(e,r)=>{m(x.map(t=>t.id===e?{...t,name:r.trim()}:t))},deleteRegisteredPlayer:e=>{m(x.filter(r=>r.id!==e))}},children:r})}},3198:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>A});var i=t(5155),o=t(8492),a=t(2531),l=t(7855),s=t(9488),n=t(357),d=t(6245),c=t(5970),h=t(9518),x=t(1008),m=t(4288),p=t(4389);let g=(0,t(645).A)((0,i.jsx)("path",{d:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8"}),"Undo");var y=t(6541),S=t(2619),u=t.n(S),f=t(1193);function A(){let{history:e,undoHistory:r}=(0,f.Q)(),t=e.reduce((e,r)=>{let t=r.sequenceNumber;return e[t]||(e[t]=[]),e[t].push(r),e},{}),S=Object.keys(t).map(Number).sort((e,r)=>r-e);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.A,{position:"static",children:(0,i.jsxs)(a.A,{children:[(0,i.jsx)(l.A,{color:"inherit",component:u(),href:"/",startIcon:(0,i.jsx)(y.A,{}),children:"戻る"}),(0,i.jsx)(s.A,{variant:"h6",component:"div",sx:{flexGrow:1,textAlign:"center"},children:"スコア履歴"}),(0,i.jsx)(n.A,{sx:{width:80}})]})}),(0,i.jsx)(d.A,{maxWidth:"md",sx:{py:3},children:0===e.length?(0,i.jsx)(c.A,{sx:{p:4,textAlign:"center"},children:(0,i.jsx)(s.A,{variant:"body1",color:"text.secondary",children:"履歴がありません"})}):(0,i.jsx)(n.A,{children:S.map(o=>(0,i.jsxs)(c.A,{sx:{mb:2,overflow:"hidden"},children:[(0,i.jsx)(n.A,{sx:{bgcolor:"grey.100",px:2,py:1},children:(0,i.jsxs)(s.A,{variant:"h6",color:"text.primary",children:[o,"ターン"]})}),(0,i.jsx)(h.A,{sx:{py:0},children:t[o].map((a,l)=>{let d,c=((r,t)=>{let i=e.filter(e=>e.playerId===t);return i.length>0&&i[0].id===r})(a.id,a.playerId);return(0,i.jsxs)(n.A,{children:[(0,i.jsx)(x.Ay,{secondaryAction:(0,i.jsx)(m.A,{edge:"end",onClick:()=>r(a.id),color:"primary",size:"large",disabled:!c,children:(0,i.jsx)(g,{})}),sx:{py:1.5},children:(0,i.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:2,width:"100%",pr:6},children:[(0,i.jsx)(s.A,{variant:"body1",sx:{minWidth:"100px",fontWeight:"bold"},children:a.playerName}),(0,i.jsx)(s.A,{variant:"body1",sx:{minWidth:"50px",textAlign:"right"},children:a.totalScore-a.score}),(0,i.jsx)(s.A,{variant:"body1",color:a.score>=0?"primary.main":"error.main",sx:{minWidth:"60px",fontWeight:"bold",textAlign:"right"},children:(d=a.score)>=0?"+".concat(d):"".concat(d)}),(0,i.jsx)(s.A,{variant:"body1",sx:{minWidth:"50px",fontWeight:"bold",textAlign:"right"},children:a.totalScore})]})}),l<t[o].length-1&&(0,i.jsx)(p.A,{})]},a.id)})})]},o))})})]})}},4091:(e,r,t)=>{Promise.resolve().then(t.bind(t,3198))},7199:(e,r,t)=>{"use strict";t.d(r,{iq:()=>i,o:()=>a,sz:()=>l,wC:()=>o});let i=10,o=1,a=0,l=999}},e=>{e.O(0,[422,229,496,441,255,358],()=>e(e.s=4091)),_N_E=e.O()}]);