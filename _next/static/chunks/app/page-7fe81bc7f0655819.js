(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{48:(e,t,i)=>{Promise.resolve().then(i.bind(i,9580))},1193:(e,t,i)=>{"use strict";i.d(t,{Q:()=>a,S:()=>o});var r=i(5155),n=i(2115),s=i(7199);let l=(0,n.createContext)(void 0),a=()=>{let e=(0,n.useContext)(l);if(!e)throw Error("useScore must be used within ScoreProvider");return e},o=e=>{let{children:t}=e,[i,a]=(0,n.useState)([{id:"1",name:"プレイヤー1",score:0},{id:"2",name:"プレイヤー2",score:0},{id:"3",name:"プレイヤー3",score:0},{id:"4",name:"プレイヤー4",score:0}]),[o,d]=(0,n.useState)([]);return(0,r.jsx)(l.Provider,{value:{players:i,history:o,addPlayer:()=>{if(i.length>=s.iq)return void alert("プレイヤーは最大".concat(s.iq,"人までです"));let e={id:Date.now().toString(),name:"プレイヤー".concat(i.length+1),score:0};a([...i,e])},removeLastPlayer:()=>{if(i.length<=s.wC)return void alert("プレイヤーは最低".concat(s.wC,"人必要です"));let e=i[i.length-1];a(i.slice(0,-1)),d(o.filter(t=>t.playerId!==e.id))},updatePlayerName:(e,t)=>{a(i.map(i=>i.id===e?{...i,name:t}:i)),d(o.map(i=>i.playerId===e?{...i,playerName:t}:i))},addScore:(e,t)=>{let r=i.find(t=>t.id===e);if(!r)return;let n=r.score+t;if(n<s.o||n>s.sz)return void alert("スコアは".concat(s.o,"-").concat(s.sz,"の範囲で入力してください"));let l=o.filter(t=>t.playerId===e).length,c={id:Date.now().toString(),playerId:e,playerName:r.name,score:t,totalScore:n,timestamp:Date.now(),sequenceNumber:l+1};a(i.map(t=>t.id===e?{...t,score:n}:t)),d([c,...o])},undoHistory:e=>{let t=o.find(t=>t.id===e);if(!t||!i.find(e=>e.id===t.playerId))return;let r=t.totalScore-t.score;a(i.map(e=>e.id===t.playerId?{...e,score:r}:e)),d(o.filter(t=>t.id!==e))}},children:t})}},7199:(e,t,i)=>{"use strict";i.d(t,{iq:()=>r,o:()=>s,sz:()=>l,wC:()=>n});let r=10,n=1,s=0,l=999},9580:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>P});var r=i(5155),n=i(8492),s=i(2531),l=i(9488),a=i(7855),o=i(6245),d=i(357),c=i(9560),h=i(6596),x=i(5057),p=i(5427),u=i(2619),j=i.n(u),m=i(2115),f=i(539),A=i(4627),g=i(6869),y=i(4288),v=i(5265),C=i(2021),w=i(9496),b=i(9880),k=i(6370),S=i(1665),I=i(1193),z=i(11);let W=e=>{let{value:t,onChange:i}=e,n=e=>{let r=t+e;r>=0&&i(r)},s={width:"50%",height:"50%",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s","&:hover":{bgcolor:"action.hover"},"&:active":{bgcolor:"action.selected"}};return(0,r.jsxs)(d.A,{sx:{position:"relative",width:"120px",height:"80px",display:"flex",flexWrap:"wrap"},children:[(0,r.jsx)(z.A,{sx:s,onClick:()=>n(10)}),(0,r.jsx)(z.A,{sx:s,onClick:()=>n(1)}),(0,r.jsx)(z.A,{sx:s,onClick:()=>n(-10)}),(0,r.jsx)(z.A,{sx:s,onClick:()=>n(-1)}),(0,r.jsx)(d.A,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",pointerEvents:"none"},children:(0,r.jsx)(l.A,{variant:"h2",fontWeight:"bold",color:"primary",children:t})})]})},E=e=>{let{player:t}=e,{updatePlayerName:i,addScore:n,history:s}=(0,I.Q)(),[o,c]=(0,m.useState)(0),[x,p]=(0,m.useState)(!1),[u,j]=(0,m.useState)(t.name),z=(0,m.useRef)(null),E=s.filter(e=>e.playerId===t.id).length,N=()=>{p(!1),j(t.name)},P=()=>{u.trim()?(i(t.id,u),p(!1)):j(t.name)};return(0,r.jsxs)(f.A,{sx:{height:"100%"},children:[(0,r.jsx)(A.A,{sx:{py:2,"&:last-child":{pb:2}},children:(0,r.jsxs)(g.A,{spacing:1,children:[(0,r.jsxs)(d.A,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,r.jsx)(y.A,{size:"small",onClick:()=>{/^プレイヤー\d+$/.test(t.name)?j(""):j(t.name),p(!0)},sx:{p:.5},children:(0,r.jsx)(S.A,{fontSize:"small"})}),(0,r.jsxs)(l.A,{variant:"h6",noWrap:!0,sx:{flexGrow:1},children:[t.name,(0,r.jsxs)(l.A,{component:"span",variant:"body2",color:"text.secondary",sx:{ml:1},children:["(",E,"ターン)"]})]})]}),(0,r.jsxs)(g.A,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{width:"100%"},children:[(0,r.jsx)(d.A,{sx:{display:"flex",justifyContent:"center",width:"120px"},children:(0,r.jsx)(l.A,{variant:"h2",sx:{fontWeight:"bold",color:"primary.main"},children:t.score})}),(0,r.jsx)(y.A,{color:"primary",onClick:()=>{0!==o&&(n(t.id,o),c(0))},disabled:0===o,sx:{bgcolor:"primary.main",color:"white",width:48,height:48,"&:hover":{bgcolor:"primary.dark"},"&:disabled":{bgcolor:"action.disabledBackground"}},children:(0,r.jsx)(h.A,{fontSize:"large"})}),(0,r.jsx)(d.A,{sx:{display:"flex",justifyContent:"center"},children:(0,r.jsx)(W,{value:o,onChange:c})})]})]})}),(0,r.jsxs)(v.A,{open:x,onClose:N,maxWidth:"xs",fullWidth:!0,TransitionProps:{onEntered:()=>{var e;null==(e=z.current)||e.focus()}},children:[(0,r.jsx)(C.A,{children:"プレイヤー名の編集"}),(0,r.jsx)(w.A,{children:(0,r.jsx)(b.A,{value:u,onChange:e=>j(e.target.value),inputRef:z,fullWidth:!0,margin:"dense",label:"プレイヤー名",onKeyDown:e=>{"Enter"===e.key&&P()}})}),(0,r.jsxs)(k.A,{children:[(0,r.jsx)(a.A,{onClick:N,children:"キャンセル"}),(0,r.jsx)(a.A,{onClick:P,variant:"contained",children:"保存"})]})]})]})};var N=i(7199);function P(){let{players:e,addPlayer:t,removeLastPlayer:i}=(0,I.Q)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.A,{position:"static",children:(0,r.jsxs)(s.A,{children:[(0,r.jsx)(l.A,{variant:"h6",component:"div",sx:{flexGrow:1},children:"スコアボード"}),(0,r.jsx)(a.A,{color:"inherit",component:j(),href:"/history",startIcon:(0,r.jsx)(p.A,{}),children:"履歴"})]})}),(0,r.jsx)(o.A,{maxWidth:"lg",sx:{py:3},children:(0,r.jsxs)(c.A,{container:!0,spacing:2,children:[e.map(e=>(0,r.jsx)(c.A,{size:6,children:(0,r.jsx)(E,{player:e})},e.id)),(0,r.jsx)(c.A,{size:12,children:(0,r.jsxs)(d.A,{sx:{display:"flex",gap:2,mt:2},children:[(0,r.jsxs)(a.A,{variant:"outlined",onClick:t,startIcon:(0,r.jsx)(h.A,{}),disabled:e.length>=N.iq,size:"large",fullWidth:!0,children:["プレイヤーを追加 (",e.length,"/",N.iq,")"]}),(0,r.jsx)(a.A,{variant:"outlined",onClick:i,startIcon:(0,r.jsx)(x.A,{}),disabled:e.length<=N.wC,size:"large",fullWidth:!0,color:"error",children:"プレイヤーを削除"})]})})]})})]})}}},e=>{e.O(0,[422,809,323,385,441,255,358],()=>e(e.s=48)),_N_E=e.O()}]);